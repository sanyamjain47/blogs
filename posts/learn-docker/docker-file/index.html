<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Dockerfiles | Sanyam's Blog</title>
<meta name=keywords content="Docker,Dockerfile"><meta name=description content="What are Dockerfiles and how to use them."><meta name=author content="Sanyam Jain"><link rel=canonical href=https://sanyamjain47.github.io/blogs/posts/learn-docker/docker-file/><link crossorigin=anonymous href=/blogs/assets/css/stylesheet.e087fd1dc76e73a35ae6d7028ddc1ba41e0131e7f9b3a6e2d019a208e6d6c4b5.css integrity="sha256-4If9Hcduc6Na5tcCjdwbpB4BMef5s6bi0BmiCObWxLU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/blogs/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://sanyamjain47.github.io/blogs/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://sanyamjain47.github.io/blogs/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://sanyamjain47.github.io/blogs/favicon-32x32.png><link rel=apple-touch-icon href=https://sanyamjain47.github.io/blogs/apple-touch-icon.png><link rel=mask-icon href=https://sanyamjain47.github.io/blogs/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Dockerfiles"><meta property="og:description" content="What are Dockerfiles and how to use them."><meta property="og:type" content="article"><meta property="og:url" content="https://sanyamjain47.github.io/blogs/posts/learn-docker/docker-file/"><meta property="og:image" content="https://sanyamjain47.github.io/blogs/images/blog-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-12-26T00:00:00+00:00"><meta property="article:modified_time" content="2023-12-26T00:00:00+00:00"><meta property="og:see_also" content="https://sanyamjain47.github.io/blogs/posts/learn-docker/basic-commands/"><meta property="og:see_also" content="https://sanyamjain47.github.io/blogs/posts/learn-docker/docker-compose/"><meta property="og:see_also" content="https://sanyamjain47.github.io/blogs/posts/learn-docker/introduction/"><meta property="og:see_also" content="https://sanyamjain47.github.io/blogs/posts/learn-docker/docker-network/"><meta property="og:see_also" content="https://sanyamjain47.github.io/blogs/posts/learn-docker/volumes-in-docker/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sanyamjain47.github.io/blogs/images/blog-cover.png"><meta name=twitter:title content="Dockerfiles"><meta name=twitter:description content="What are Dockerfiles and how to use them."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://sanyamjain47.github.io/blogs/posts/"},{"@type":"ListItem","position":2,"name":"Learning Docker","item":"https://sanyamjain47.github.io/blogs/posts/learn-docker/"},{"@type":"ListItem","position":3,"name":"Dockerfiles","item":"https://sanyamjain47.github.io/blogs/posts/learn-docker/docker-file/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Dockerfiles","name":"Dockerfiles","description":"What are Dockerfiles and how to use them.","keywords":["Docker","Dockerfile"],"articleBody":"Dockerfiles Dockerfiles are used to build images. They are a list of instructions that are used to build an image. docker build -t is used to build an image from a Dockerfile. Example This example is based on https://github.com/sidpalas/devops-directive-docker-course/tree/main/05-example-web-application . This is part of the course that I am using to learn Docker.\napi-node FROM ubuntu RUN apt update RUN apt install nodejs -y In the above example, we are using the ubuntu image as the base image. Currently, we are not specifying the version of the image. This is not recommended. We should always specify the version of the image. Also, every command in the Dockerfile creates a new layer. This is not recommended. We should always try to combine multiple commands into a single command. We are using the RUN command to run the commands. Now, let’s merge the two RUN commands into a single command. Copy the files also now. We also added npm since we forgot to add it earlier. FROM ubuntu RUN apt update \u0026\u0026 apt install nodejs npm -y COPY . . RUN npm install Now, add the CMD command to run the application. FROM ubuntu RUN apt update \u0026\u0026 apt install nodejs npm -y COPY . . RUN npm install CMD [\"npm\",\"run\",\"dev\"] Now let’s start optimizing the Dockerfile. For starters, since we are only using this image for nodejs, we can use the node image as the base image instead of the ubuntu image. Also, we should specify the version of the image. Let’s use node:19.6-alpine as the image. Instead of copying the whole source directory, we can copy the package.json file first and then run npm install. This will allow us to cache the node_modules folder. This will speed up the build process. We can also use WORKDIR to set the working directory to /app. This will allow us to run the npm install command without specifying the path. When using the copy command we can have some files that we don’t want to copy. We can use .dockerignore to specify the files that we don’t want to copy. Or we can use the COPY command to copy only the files that we want to copy. We now change npm run dev to node index.js. All the changes are shown below. FROM node:19.6-alpine WORKDIR /usr/src/app COPY package*.json ./ RUN npm install COPY ./src . CMD [\"node\",\"index.js\"] Up until now, we have been running the commands as a root user. This is not recommended. We should always run the commands as a non-root user. We can use the USER command to specify the user that we want to run the commands as. This involves creating a user and then switching to that user. Also, while copying the files, we need to make sure that the user has the required permissions to copy the files. We can use the chown command to change the owner of the files. FROM node:19.6-alpine WORKDIR /usr/src/app COPY package*.json ./ RUN npm install USER node COPY --chown=node:node ./src . CMD [\"node\",\"index.js\"] – Now, We can do some node.js specific optimizations.\nWe can start by using an ENV variable to specify the environment. This will allow us to use different configurations for different environments. We can also use npm ci instead of npm install. This will install the exact versions of the dependencies specified in the package-lock.json file. This will speed up the build process. Adding --only=production will install only the production dependencies. This will reduce the size of the image. Also, we would like to EXPOSE the port 3000 so that we can access the application from outside the container. FROM node:19.6-alpine WORKDIR /usr/src/app ENV NODE_ENV production COPY package*.json ./ RUN npm ci --only=production USER node COPY --chown=node:node ./src . EXPOSE 3000 CMD [\"node\",\"index.js\"] We can change npm ci --only=production to --mount=type=cache,target=/usr/src/app/.npm \\ npm set cache /usr/src/app/.npm \u0026\u0026 \\ npm ci --only=production to use a cache volume. This will speed up the build process even more.\ngo-app We start with the golang image. We set the Workdir. We go with a naive approach and then optimize it. from golang WORKDIR /app COPY . . RUN go mod download CMD [\"go\",\"run\",\"./main.go\"] Start by adding a version to the image. We use golang:1.19-alpine as the image. Also, when using go, we don’t want to use go run main.go as our command. We want to build the binary and then run the binary. Also, we want to download the dependencies first and then copy the source code. This will allow us to cache the dependencies. This will speed up the build process. FROM golang:1.19-alpine WORKDIR /app COPY go.mod go.sum ./ RUN go mod download COPY . . RUN go build -o api-golang CMD [\"./api-golang\"] For this image, we can do 1 more thing. We can use a multi-stage build. This will allow us to build the binary in one stage and then copy the binary to the final image. This will reduce the size of the image. There is an image called scratch that is used to create images from scratch. This is useful when we want to create images that don’t have any dependencies. We can use this image as the base image for our final image. FROM golang:1.19-buster AS build WORKDIR /app COPY go.mod go.sum ./ RUN go mod download COPY . . RUN go build \\ -ldflags=\"-linkmode external -extldflags -static\" \\ -tags netgo \\ -o api-golang FROM scratch COPY --from=build /app/api-golang /app/api-golang CMD [\"/app/api-golang\"] We can also use ENV to specify the environment. In gin the package used in golang to create the api, we can use ENV GIN_MODE=release to specify the environment. We can also use EXPOSE to expose the port 8080 so that we can access the application from outside the container. Also, we can use a cache mount similarly to how we did it in the api-node image. Note, we have also changed the image from alpine to buster. This is because alpine doesn’t have glibc installed. This causes issues when running the binary. So, we use buster instead. Since, we are using the buster image as an intermediate image, this doesn’t affect the size of the final image. FROM golang:1.19-buster AS build WORKDIR /app COPY go.mod go.sum ./ RUN --mount=type=cache,target=/go/pkg/mod \\ --mount=type=cache,target=/root/.cache/go-build \\ go mod download COPY . . RUN go build \\ -ldflags=\"-linkmode external -extldflags -static\" \\ -tags netgo \\ -o api-golang FROM scratch ENV GIN_MODE release COPY --from=build /app/api-golang /app/api-golang EXPOSE 8080 CMD [\"/app/api-golang\"] Last thing we can do is to use a non-root user. This is similar to what we did in the api-node image. FROM golang:1.19-buster AS build WORKDIR /app RUN useradd -u 10001 appuser COPY go.mod go.sum ./ RUN --mount=type=cache,target=/go/pkg/mod \\ --mount=type=cache,target=/root/.cache/go-build \\ go mod download COPY . . RUN go build \\ -ldflags=\"-linkmode external -extldflags -static\" \\ -tags netgo \\ -o api-golang FROM scratch ENV GIN_MODE release COPY --from=build /etc/passwd /etc/passwd COPY --from=build /app/api-golang /app/api-golang USER appuser EXPOSE 8080 CMD [\"/app/api-golang\"] react-app We start with the node image. This would be very similar to the api-node image. Not many optimizations to do here. We learnt alot about optimizing the api-node image. We can use the same optimizations here. We can also use a multi-stage build to reduce the size of the image. FROM node:19.4-bullseye as build WORKDIR /user/src/app COPY package*.json ./ RUN --mount=type=cache,target=/usr/src/app/.npm \\ npm set cache /usr/src/app/.npm \u0026\u0026 \\ npm ci COPY . . RUN npm run build ### FROM nginxinc/nginx-unprivileged:1.23-alpine-perl COPY nginx.conf /etc/nginx/conf.d/default.conf COPY --from=build /usr/src/app/dist /usr/share/nginx/html EXPOSE 8080 General Principles while writing Dockerfiles Pin Speicific Versions Base images System Dependencies Application Dependencies Use small + secure base images Protect the layer cache Use mutli-stage builds Order commands by frequency of change Copy dependency requirements first -\u003e Intall dependencies -\u003e Copy source code Use Cache mounts Use COPY –link Be explicit Set working directory Set environment variables Set standard port Avoid unnecessary packages COPY specific files Use .dockerignore Use non-root user Install only production dependencies Notes COPY --link is very useful in building an image as this makes the copy step an independent step. This means that if the source code changes, the cache for the dependencies will not be invalidated. This will speed up the build process.\n","wordCount":"1363","inLanguage":"en","datePublished":"2023-12-26T00:00:00Z","dateModified":"2023-12-26T00:00:00Z","author":[{"@type":"Person","name":"Sanyam Jain"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://sanyamjain47.github.io/blogs/posts/learn-docker/docker-file/"},"publisher":{"@type":"Organization","name":"Sanyam's Blog","logo":{"@type":"ImageObject","url":"https://sanyamjain47.github.io/blogs/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://sanyamjain47.github.io/blogs/ accesskey=h title="Sanyam's Blog (Alt + H)">Sanyam's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://sanyamjain47.github.io/blogs/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://sanyamjain47.github.io/blogs/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://sanyamjain47.github.io/blogs/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://sanyamjain47.github.io/blogs/series/ title=Series><span>Series</span></a></li><li><a href=https://sanyamjain47.github.io/blogs/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sanyamjain47.github.io/blogs/>Home</a>&nbsp;»&nbsp;<a href=https://sanyamjain47.github.io/blogs/posts/>Posts</a>&nbsp;»&nbsp;<a href=https://sanyamjain47.github.io/blogs/posts/learn-docker/>Learning Docker</a></div><h1 class="post-title entry-hint-parent">Dockerfiles</h1><div class=post-meta><span title='2023-12-26 00:00:00 +0000 UTC'>December 26, 2023</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Sanyam Jain</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#dockerfiles aria-label=Dockerfiles>Dockerfiles</a></li><li><a href=#example aria-label=Example>Example</a><ul><li><a href=#api-node aria-label=api-node>api-node</a></li><li><a href=#go-app aria-label=go-app>go-app</a></li><li><a href=#react-app aria-label=react-app>react-app</a></li></ul></li><li><a href=#general-principles-while-writing-dockerfiles aria-label="General Principles while writing Dockerfiles">General Principles while writing Dockerfiles</a><ul><li><a href=#notes aria-label=Notes>Notes</a></li></ul></li></ul></div></details></div><div class=post-content><h1 id=dockerfiles>Dockerfiles<a hidden class=anchor aria-hidden=true href=#dockerfiles>#</a></h1><ul><li>Dockerfiles are used to build images.</li><li>They are a list of instructions that are used to build an image.</li><li><code>docker build -t &lt;image_name> &lt;path_to_dockerfile></code> is used to build an image from a Dockerfile.</li></ul><h1 id=example>Example<a hidden class=anchor aria-hidden=true href=#example>#</a></h1><blockquote><p>This example is based on <a href=https://github.com/sidpalas/devops-directive-docker-course/tree/main/05-example-web-application>https://github.com/sidpalas/devops-directive-docker-course/tree/main/05-example-web-application</a> . This is part of the course that I am using to learn Docker.</p></blockquote><h2 id=api-node>api-node<a hidden class=anchor aria-hidden=true href=#api-node>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> ubuntu</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> apt update<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> apt install nodejs -y<span class=err>
</span></span></span></code></pre></div><ul><li>In the above example, we are using the <code>ubuntu</code> image as the base image.</li><li>Currently, we are not specifying the version of the image. This is not recommended. We should always specify the version of the image.</li><li>Also, every command in the Dockerfile creates a new layer. This is not recommended. We should always try to combine multiple commands into a single command.</li><li>We are using the <code>RUN</code> command to run the commands.</li><li>Now, let&rsquo;s merge the two <code>RUN</code> commands into a single command.</li><li>Copy the files also now.</li><li>We also added <code>npm</code> since we forgot to add it earlier.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> ubuntu</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> apt update <span class=o>&amp;&amp;</span> apt install nodejs npm -y<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> npm install<span class=err>
</span></span></span></code></pre></div><ul><li>Now, add the <code>CMD</code> command to run the application.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> ubuntu</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> apt update <span class=o>&amp;&amp;</span> apt install nodejs npm -y<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> npm install<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;npm&#34;</span><span class=p>,</span><span class=s2>&#34;run&#34;</span><span class=p>,</span><span class=s2>&#34;dev&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><ul><li>Now let&rsquo;s start optimizing the Dockerfile.</li><li>For starters, since we are only using this image for nodejs, we can use the <code>node</code> image as the base image instead of the <code>ubuntu</code> image. Also, we should specify the version of the image. Let&rsquo;s use <code>node:19.6-alpine</code> as the image.</li><li>Instead of copying the whole source directory, we can copy the <code>package.json</code> file first and then run <code>npm install</code>. This will allow us to cache the <code>node_modules</code> folder. This will speed up the build process.</li><li>We can also use <code>WORKDIR</code> to set the working directory to <code>/app</code>. This will allow us to run the <code>npm install</code> command without specifying the path.</li><li>When using the copy command we can have some files that we don&rsquo;t want to copy. We can use <code>.dockerignore</code> to specify the files that we don&rsquo;t want to copy. Or we can use the <code>COPY</code> command to copy only the files that we want to copy.</li><li>We now change <code>npm run dev</code> to <code>node index.js</code>.</li><li>All the changes are shown below.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> node:19.6-alpine</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /usr/src/app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> package*.json ./<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> npm install<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> ./src .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;node&#34;</span><span class=p>,</span><span class=s2>&#34;index.js&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><ul><li>Up until now, we have been running the commands as a root user. This is not recommended. We should always run the commands as a non-root user.</li><li>We can use the <code>USER</code> command to specify the user that we want to run the commands as. This involves creating a user and then switching to that user. Also, while copying the files, we need to make sure that the user has the required permissions to copy the files.</li><li>We can use the <code>chown</code> command to change the owner of the files.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> node:19.6-alpine</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /usr/src/app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> package*.json ./<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> npm install<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>USER</span><span class=s> node</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --chown<span class=o>=</span>node:node ./src .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;node&#34;</span><span class=p>,</span><span class=s2>&#34;index.js&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><p>&ndash; Now, We can do some <code>node.js</code> specific optimizations.</p><ul><li>We can start by using an <code>ENV</code> variable to specify the environment. This will allow us to use different configurations for different environments.</li><li>We can also use <code>npm ci</code> instead of <code>npm install</code>. This will install the exact versions of the dependencies specified in the <code>package-lock.json</code> file. This will speed up the build process. Adding <code>--only=production</code> will install only the production dependencies. This will reduce the size of the image.</li><li>Also, we would like to <code>EXPOSE</code> the port <code>3000</code> so that we can access the application from outside the container.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> node:19.6-alpine</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /usr/src/app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> NODE_ENV production<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> package*.json ./<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> npm ci --only<span class=o>=</span>production<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>USER</span><span class=s> node</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --chown<span class=o>=</span>node:node ./src .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 3000</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;node&#34;</span><span class=p>,</span><span class=s2>&#34;index.js&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><blockquote><p>We can change <code>npm ci --only=production</code> to <code>--mount=type=cache,target=/usr/src/app/.npm \ npm set cache /usr/src/app/.npm && \ npm ci --only=production</code> to use a cache volume. This will speed up the build process even more.</p></blockquote><h2 id=go-app>go-app<a hidden class=anchor aria-hidden=true href=#go-app>#</a></h2><ul><li>We start with the golang image.</li><li>We set the Workdir.</li><li>We go with a naive approach and then optimize it.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>from</span><span class=s> golang</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> go mod download<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;go&#34;</span><span class=p>,</span><span class=s2>&#34;run&#34;</span><span class=p>,</span><span class=s2>&#34;./main.go&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><ul><li>Start by adding a version to the image. We use <code>golang:1.19-alpine</code> as the image.</li><li>Also, when using go, we don&rsquo;t want to use <code>go run main.go</code> as our command. We want to build the binary and then run the binary.</li><li>Also, we want to download the dependencies first and then copy the source code. This will allow us to cache the dependencies. This will speed up the build process.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> golang:1.19-alpine</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> go.mod go.sum ./<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> go mod download<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> go build -o api-golang<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;./api-golang&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><ul><li>For this image, we can do 1 more thing. We can use a multi-stage build. This will allow us to build the binary in one stage and then copy the binary to the final image. This will reduce the size of the image.</li><li>There is an image called <code>scratch</code> that is used to create images from scratch. This is useful when we want to create images that don&rsquo;t have any dependencies. We can use this image as the base image for our final image.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> golang:1.19-buster AS build</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> go.mod go.sum ./<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> go mod download<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> go build <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -ldflags<span class=o>=</span><span class=s2>&#34;-linkmode external -extldflags -static&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -tags netgo <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -o api-golang<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> scratch</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --from<span class=o>=</span>build /app/api-golang /app/api-golang<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;/app/api-golang&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><ul><li>We can also use <code>ENV</code> to specify the environment. In <code>gin</code> the package used in golang to create the api, we can use <code>ENV GIN_MODE=release</code> to specify the environment.</li><li>We can also use <code>EXPOSE</code> to expose the port <code>8080</code> so that we can access the application from outside the container.</li><li>Also, we can use a cache mount similarly to how we did it in the <code>api-node</code> image.</li><li>Note, we have also changed the image from <code>alpine</code> to <code>buster</code>. This is because <code>alpine</code> doesn&rsquo;t have <code>glibc</code> installed. This causes issues when running the binary. So, we use <code>buster</code> instead. Since, we are using the <code>buster</code> image as an intermediate image, this doesn&rsquo;t affect the size of the final image.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> golang:1.19-buster AS build</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> go.mod go.sum ./<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> --mount<span class=o>=</span><span class=nv>type</span><span class=o>=</span>cache,target<span class=o>=</span>/go/pkg/mod <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --mount<span class=o>=</span><span class=nv>type</span><span class=o>=</span>cache,target<span class=o>=</span>/root/.cache/go-build <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    go mod download<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> go build <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -ldflags<span class=o>=</span><span class=s2>&#34;-linkmode external -extldflags -static&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -tags netgo <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -o api-golang<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> scratch</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> GIN_MODE release<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --from<span class=o>=</span>build /app/api-golang /app/api-golang<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 8080</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;/app/api-golang&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><ul><li>Last thing we can do is to use a non-root user. This is similar to what we did in the <code>api-node</code> image.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> golang:1.19-buster AS build</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> useradd -u <span class=m>10001</span> appuser<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> go.mod go.sum ./<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> --mount<span class=o>=</span><span class=nv>type</span><span class=o>=</span>cache,target<span class=o>=</span>/go/pkg/mod <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --mount<span class=o>=</span><span class=nv>type</span><span class=o>=</span>cache,target<span class=o>=</span>/root/.cache/go-build <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    go mod download<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> go build <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -ldflags<span class=o>=</span><span class=s2>&#34;-linkmode external -extldflags -static&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -tags netgo <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -o api-golang<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> scratch</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> GIN_MODE release<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --from<span class=o>=</span>build /etc/passwd /etc/passwd<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --from<span class=o>=</span>build /app/api-golang /app/api-golang<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>USER</span><span class=s> appuser</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 8080</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;/app/api-golang&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><h2 id=react-app>react-app<a hidden class=anchor aria-hidden=true href=#react-app>#</a></h2><ul><li>We start with the <code>node</code> image. This would be very similar to the <code>api-node</code> image.</li><li>Not many optimizations to do here. We learnt alot about optimizing the <code>api-node</code> image. We can use the same optimizations here. We can also use a multi-stage build to reduce the size of the image.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> node:19.4-bullseye as build</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /user/src/app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> package*.json ./<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> --mount<span class=o>=</span><span class=nv>type</span><span class=o>=</span>cache,target<span class=o>=</span>/usr/src/app/.npm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    npm <span class=nb>set</span> cache /usr/src/app/.npm <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    npm ci<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> npm run build<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c>###</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> nginxinc/nginx-unprivileged:1.23-alpine-perl </span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> nginx.conf /etc/nginx/conf.d/default.conf<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --from<span class=o>=</span>build /usr/src/app/dist /usr/share/nginx/html<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 8080</span><span class=err>
</span></span></span></code></pre></div><h1 id=general-principles-while-writing-dockerfiles>General Principles while writing Dockerfiles<a hidden class=anchor aria-hidden=true href=#general-principles-while-writing-dockerfiles>#</a></h1><ul><li>Pin Speicific Versions<ul><li>Base images</li><li>System Dependencies</li><li>Application Dependencies</li></ul></li><li>Use small + secure base images</li><li>Protect the layer cache<ul><li>Use mutli-stage builds</li><li>Order commands by frequency of change</li><li>Copy dependency requirements first -> Intall dependencies -> Copy source code</li><li>Use Cache mounts</li><li>Use COPY &ndash;link</li></ul></li><li>Be explicit<ul><li>Set working directory</li><li>Set environment variables</li><li>Set standard port</li></ul></li><li>Avoid unnecessary packages<ul><li>COPY specific files</li><li>Use .dockerignore</li></ul></li><li>Use non-root user</li><li>Install only production dependencies</li></ul><h2 id=notes>Notes<a hidden class=anchor aria-hidden=true href=#notes>#</a></h2><blockquote><p><code>COPY --link</code> is very useful in building an image as this makes the copy step an independent step. This means that if the source code changes, the cache for the dependencies will not be invalidated. This will speed up the build process.</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://sanyamjain47.github.io/blogs/tags/docker/>Docker</a></li><li><a href=https://sanyamjain47.github.io/blogs/tags/dockerfile/>Dockerfile</a></li></ul><nav class=paginav><a class=prev href=https://sanyamjain47.github.io/blogs/posts/learn-docker/docker-network/><span class=title>« Prev</span><br><span>Docker Networks</span>
</a><a class=next href=https://sanyamjain47.github.io/blogs/posts/learn-docker/volumes-in-docker/><span class=title>Next »</span><br><span>Volumes in Docker</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Dockerfiles on x" href="https://x.com/intent/tweet/?text=Dockerfiles&amp;url=https%3a%2f%2fsanyamjain47.github.io%2fblogs%2fposts%2flearn-docker%2fdocker-file%2f&amp;hashtags=Docker%2cDockerfile"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dockerfiles on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsanyamjain47.github.io%2fblogs%2fposts%2flearn-docker%2fdocker-file%2f&amp;title=Dockerfiles&amp;summary=Dockerfiles&amp;source=https%3a%2f%2fsanyamjain47.github.io%2fblogs%2fposts%2flearn-docker%2fdocker-file%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dockerfiles on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fsanyamjain47.github.io%2fblogs%2fposts%2flearn-docker%2fdocker-file%2f&title=Dockerfiles"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dockerfiles on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsanyamjain47.github.io%2fblogs%2fposts%2flearn-docker%2fdocker-file%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dockerfiles on whatsapp" href="https://api.whatsapp.com/send?text=Dockerfiles%20-%20https%3a%2f%2fsanyamjain47.github.io%2fblogs%2fposts%2flearn-docker%2fdocker-file%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dockerfiles on telegram" href="https://telegram.me/share/url?text=Dockerfiles&amp;url=https%3a%2f%2fsanyamjain47.github.io%2fblogs%2fposts%2flearn-docker%2fdocker-file%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dockerfiles on ycombinator" href="https://news.ycombinator.com/submitlink?t=Dockerfiles&u=https%3a%2f%2fsanyamjain47.github.io%2fblogs%2fposts%2flearn-docker%2fdocker-file%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://sanyamjain47.github.io/blogs/>Sanyam's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>